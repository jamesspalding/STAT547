---
title: "STAT547 Final Report"
author: "James Spalding"
date: "2024-04-05"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(include = F, eval = F, echo = F)

source("functions.R")
source("species-joint-data.R")
source(paste0(getwd(),"/files/powerGraphs/Power-graphs-mean.R"))
```

```{r}
# Comparisons by joint

#H0: Misorientation angle is the same between joints
#Ha: It isnt

#Bonferroni adjustment: .05/10 = .005

arrayPerm(array.CubCal, array.Mt5CubAP)
arrayPerm(array.CubCal, array.NavCub)
arrayPerm(array.CubCal, array.NavTal)
arrayPerm(array.CubCal, array.TalCal, alt = "greater") #

arrayPerm(array.Mt5CubAP, array.NavCub)
arrayPerm(array.Mt5CubAP, array.NavTal, alt = "greater") #
arrayPerm(array.Mt5CubAP, array.TalCal, alt = "greater") #

arrayPerm(array.NavCub, array.NavTal)
arrayPerm(array.NavCub, array.TalCal, alt = "greater") #

arrayPerm(array.NavTal, array.TalCal, alt = "greater") #
```



```{r}
# Comparisons by species

#H0: Misorientation angle is the same between species
#Ha: It isnt

#Bonferroni adjustment: .05/3 = .0167


arrayPerm(humanArray, chimpArray)

arrayPerm(humanArray, baboonArray)

arrayPerm(baboonArray, chimpArray)

#Conclusion: Average misorientation angle is the same for all contrasts between species.
```


```{r}
# Comparisons by joint and species

#H0: Misorientation angle of specific joint is the same between species
#Ha: It isnt

#Bonferroni adjustment: .05/3 = .0167

### CubCal ###
arrayPerm(human.CubCal, chimp.CubCal)
arrayPerm(human.CubCal, baboon.CubCal)
arrayPerm(baboon.CubCal, chimp.CubCal)
#No Diff


### Mt5CubAP (N/A for Baboon) ###
#alpha = .05
arrayPerm(human.CubCal, chimp.CubCal, alt = "greater") #
#Humans have greater misorient angle than chimps.


### NavCub ###
arrayPerm(human.NavCub, chimp.NavCub)
arrayPerm(human.NavCub, baboon.NavCub)
arrayPerm(baboon.NavCub, chimp.NavCub)
#None significant


### NavTal ###
arrayPerm(human.NavTal, chimp.NavTal, alt = "greater") #
arrayPerm(human.NavTal, baboon.NavTal, alt = "greater") #
arrayPerm(baboon.NavTal, chimp.NavTal)
#Humans have greater misorient angle than both chimps and baboons.


### TalCal ###
arrayPerm(human.TalCal, chimp.TalCal)
arrayPerm(human.TalCal, baboon.TalCal, alt = "greater") #
arrayPerm(baboon.TalCal, chimp.TalCal)
#Humans have greater misorient angle than both chimps and baboons.
```

# Results

First, I looked to see if there were differences in the average misorientation angle between the different joints studied; independent of the species. In order to check this, I performed permutation tests to test for differences between joints. Since there were 5 joints in the study, 10 comparisons were computed. A test-wise $\alpha$ level of 0.005 was used, which leads to a family-wide $\alpha$ level of 0.05.

This test resulted in significant evidence of the following differences in mean misorientation angles:

* CubCal > TalCal

* Mt5CubAP > NavTal

* Mt5CubAP > TalCal

* NavCub > TalCal

* NavTal > TalCal

```{r, eval=T, echo = T}
Comparison = c("CubCal - Mt5CubAP",
               "CubCal - NavCub",
               "CubCal - NavTal",
               "CubCal - TalCal", #
               "Mt5CubAP - NavCub",
               "Mt5CubAP - NavTal", #
               "Mt5CubAP - TalCal", #
               "NavCub - NavTal",
               "NavCub - TalCal", #
               "NavTal - TalCal") #

PValue = c("0.0664", "0.4577", "0.0358", "0.0000 *", "0.3474", "0.0008 *", "0.0000 *", "0.0287", "0.0010 *", "0.0010 *")

Result = c("CubCal = Mt5CubAP",
           "CubCal = NavCub",
           "CubCal = NavTal",
           "CubCal > TalCal", #
           "Mt5CubAP = NavCub",
           "Mt5CubAP > NavTal", #
           "Mt5CubAP > TalCal", #
           "NavCub = NavTal",
           "NavCub > TalCal", #
           "NavTal > TalCal") #

data.frame(Comparison, PValue, Result)
```


There was no significant differences in the tests between CubCal and Mt5CubAP, CubCal and NavCub, CubCal and NavTal, Mt5CubAP and NavCub, and NavCub and NavTal.








Introduction: Give an overview of the general type of data being considered and its structure
(basically a brief overview of 3-D rotation data). Give an overview of the human, baboon, and
chimp joint data that will be explored later. Feel free to use information on how the data was
collected from the Brief Project Overview document for this.



Permutation Test: Describe the permutation test for comparing the parameter of interest
(spread or mean depending on what you worked on) for two populations. Include things such as
what statistic is used and how it’s calculated, how the permutations are done, and how the p-
value is calculated. This should have enough detail that another student familiar with 3-D
rotation data could use what you’ve described to write their own code to implement the
permutation test.



Simulation Study: Discuss the simulation study done to explore power. What simulations were
run and what general trends are you seeing in the graphs you ended up with? Do these results
match what you’d expect to happen regarding change in sample size and change in spread
(kappa)?



Application to joint data: Discuss the results of applying your permutation test to the joint data.
Which species were found to be significantly different for which joints?

