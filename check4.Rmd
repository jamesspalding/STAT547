---
title: "Untitled"
author: "James Spalding"
date: "2024-03-19"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
source(paste0(getwd(),"/files/Power-graphs-mean.R")) #data
source("functions.R")
library(BSDA)
```

```{r}
pvalGraphs = function(n,k, ang){
  data = generateData(n,k, ANG = ang)
    A = data[[1]]
    B = data[[2]]
  
  result = arrayPerm(A,B,silent = T)
  angle = result[[1]]
  pval = result[[2]]
  
  return(pval)
}

pvalGraphs(10,5, .1)
```

```{r}
samps = 100

power=power50=power100=rep(0,30)
mvals=seq(.02,.6,,30) #breaks at 0.
starttime = Sys.time()

for(m in 1:30){

  mval=mvals[m]
  count10=0 
  count50=0
  count100=0
  
  for(i in 1:samps){ 
    if(pvalGraphs(10,5,mval)<.05){
      count10=count10+1
    }
    if(pvalGraphs(50,5,mval)<.05){
      count50=count50+1
    }
    if(pvalGraphs(100,5,mval)<.05){
      count100=count100+1
    }
  }
  
  power[m]=count10/samps
  power50[m]=count50/samps
  power100[m]=count100/samps

}

endtime = Sys.time()
endtime-starttime

ggplot(mapping = aes(mvals,power))+
  geom_smooth(color = "black", se=F)+ 
  geom_smooth(aes(mvals,power50),color="blue",se=F)+
  geom_smooth(aes(mvals,power100),color="red",se=F)+
  theme_minimal()+
  labs(x="Angle", y="Power", title="Power Graph")
```



